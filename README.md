# diploidFisher

NOTE: A couple small bugs have been fixed since upload!

"Population_Creation.slim" and "Finite_Population_Creation.slim" are used to run diploid simulations using Fisher's geometric model. Each simulation should be given a unique identifying "run number", represented as the run_number constant in the slim file.

"Population_Creation.slim" produces three files: a "vcf.dat" file containing genomic information for all individuals in the simulation, a "mutationInfo.csv" file containing the mutational vector for each mutation present at the end of the simulation (alongside other information), and an "experiment" file, which contains a record of the parameters used in the simulation, alongside other end-simulation information. If an "experiment" file already exists in the working directory, the information is instead added as a new line. The vcf and mutationInfo files are numbered based on the run number assigned to the simulation (eg: vcf1.dat and mutationInfo1.csv for run number 1).

"Finite_Population_Creation.slim" works similarly, but insteads generates a random set of mutational vectors for two isolated populations to draw from, then outputs the end information for both populations as described previously. If the slim file is given a run number of X, then these two populations are assigned run numbers "X.1" and "X.2", and the simulation outputs "vcfX.1.dat", "vcfX.2.dat", "mutationInfoX.1.csv", "mutationInfoX.2.csv" files and updates the "experiment" file found in the working directory. 

"Hybrid_Creation.slim" is used to generate the fitness of F1, F2, and BC hybrids from two given populations, as well as the fitness for the two parental populations (p1 and p2). If the working directory of "Hybrid_Creation.slim" is where the output files of "Population_Creation.slim" or "Finite_Population_Creation.slim" are located, then by specifing the run numbers of two simulations through the run_number1 and run_number2 constants in the slim file, the two end products of the respective simulations are mated to produce the hybrid populations. "Hybrid_Creation.slim" produces a "fitnesses.csv" file, or updates one if it already exists in the working directory. This file contains the population (p1, p2,F1,F2, or BC), the fitness, and the run numbers of both parental populations for all individuals in the p1, p2, F1, F2, and BC populations. Additionally, this fitnesses file also contains the number of homozygous mutations in each individual that were originally found as heterozygous mutations in either one of the parental populations.
